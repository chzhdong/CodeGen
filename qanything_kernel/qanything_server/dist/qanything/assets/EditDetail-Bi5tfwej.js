import{_ as e}from"./bot-avatar-CBCRm2Zm.js";import{_ as a}from"./knowledge-zhu8jsrY.js";import{u as t}from"./useBots-DbnaIHJs.js";import{r as l,u as s,a as o,b as n,C as i}from"./utils-DgQiGfGs.js";import{g as c,u as r}from"./index-B-VGBmzJ.js";import{a as u,C as d}from"./ChatSettingDialog-B0MdGUH7.js";import{u as p}from"./useChatSetting-C_Q_RWik.js";import{u as v}from"./useBotsChat-BkotZGHn.js";import{d as m,j as g,r as h,a as k,o as A,k as f,B as b,q as w,c as y,x as _,y as C,v as S,D as x,L as I,J as B,C as F,n as T,z as D,M as R,Q as q,R as L,A as j,b as U,F as K,G as H,K as Q,a1 as z,W as E,l as O,S as V,Z as Y,E as M,p as X}from"./index-BOQWRSv-.js";import{I as Z}from"./index-C23k2m5x.js";import{_ as W}from"./ActionButton-kxRHFmPt.js";import{u as P,a as G,b as N,D as J,h as $,C as ee,c as ae,_ as te,T as le,f as se}from"./ChatInfoPanel-B2MnKrGD.js";import{_ as oe}from"./lock-DmQwPPsI.js";import{u as ne,_ as ie,I as ce}from"./useChatSource-CVdT_vQJ.js";import"./index-4PmJ48K0.js";import"./index-C0drqHzp.js";import"./RightOutlined-k6Ldo487.js";import"./slide-a1Tp5F_n.js";import"./CheckOutlined-C0I0DHjL.js";import"./index-CMd10nF3.js";import"./collapseMotion-CxcQHKaF.js";import"./class-FJ4HjPo2.js";const re=e=>(q("data-v-b73852ad"),e=e(),L(),e),ue={class:"bot-detail-edit-comp"},de={class:"name-avatar"},pe=re((()=>w("img",{src:e,alt:"avatar"},null,-1))),ve={class:"title"},me={class:"title"},ge={class:"title"},he=re((()=>w("span",null,"*",-1))),ke=re((()=>w("img",{class:"knowledge-icon",src:a,alt:"knowledge"},null,-1))),Ae={class:"kb-name"},fe=["onClick"],be=re((()=>w("img",{class:"add-knowedge",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAOBSURBVFiFzZixdeJAEIb/WZAiAjqADiiBwAUQOHOg97BlhQQUQEABBIRCZ7+ngMwBBThQARfQgegAv4cTOHYuuFksQBJIYM5/AojVzqcZ7ezsEDNX8IOl/jfAKVUvuTkMw/p6vW4TUUNrXWfmBgAQ0UIptWTmhW3bkeM4y7I2qGiIwzCsbzYbZ7vddoioxcz1k0aIZkQ0c103/FZA3/d7RDQwUES0ZOY5gDkRLYkoBgBmbsqYFoB2YopYKTUsAnoW4Ovra2uz2bwBaMqlSCk1Pid85jXQWvcSsHGtVrt7eHhYXAwYBIHDzCPxSCQeiE5NnDWX1noAoCkef3Jdd1YacDKZDJh5ID/Hnuf1y4Adyvf9EYAeABDR8Pn5eVgYMAiCjtb6TX72Pc8bXwPOKPnwSqnHrPcyFXA6nTY+Pz9/M3P91BNeIt/3ewBGRLSsVqt33W53fjgmNVGvVqt3eefG3wUHABKVMTPXZREe6QgwCAIH/1ZrfK13Lk9iIwLQFI/mA8oqg1KqsOeCIHDSjJySsUVEgzAM9xL/HmDCe1GZrK+1fgEwKnqfpK1IQu1kAjJzBwCUUlddsefI2Nxut5296+ZLGIZ1A2jbdqlEfIls244kebeSYd4Brtdrsw1dVH2UleM4S2aeM3M9wfIFSEQN+XqUi26o+QHLF6DWeleh3J7rn4xtwwIkCtZEsRnnTSIb/kveGN/3/2T8lbtlElHMzDsWoETJn3y6olJKFY7OzoNEtBD6Zt4NZntK+894zvO8UkcJY5uIdnVicpHEMqi0hy6VsZ30dDLEH/LZuiXUgVoAwMzHHsxKlLeS2GwbliPArER5KxmbRDRLbhR7q7hSqcwAQA44N5WxSUR7Z5Q9QMuyQkmW7SAIynixr5R6LHqTVFFtAPFhFbUHKGEeAl91YRF5njcuWaZl1qBHiVryXAygLaevb5XYaCLFe6mAAGBZ1r2EulemQj5Xk8lkAKBHRMtarXaXNiYVsNvtzonInEdGMtFV5ft+zxw7iegpq8uQuRe7rhsS0RAAmHlwzXDLXCOBG+Z1F85pfXSY+ZdsQ4WbPwdztWVBtGVT6J+a66zm0XQ6baxWq3dcsXlkWdZ92kG9FKBRsvmTuBwhp/2W7CFKu25YpI1SuIFpQJm5Yw5ZuQakh1ipVGaWZYVFzzulAI3yWsDizY+bt4BvrR/f5f8LxA8rSSHVBD4AAAAASUVORK5CYII=",alt:"icon"},null,-1))),we={class:"save"},ye={class:"title"},_e={class:"chat-setting-form-footer"},Ce=j(m({__name:"BotDetailEdit",setup(e,{expose:a}){const{curBot:o,knowledgeList:n}=g(t()),{QA_List:i}=g(v()),{setSelectKnowledgeVisible:r,setCurBot:d}=t(),{setChatSettingConfigured:m}=p(),{chatSettingFormActive:q}=g(p()),{bots:L,common:j}=c(),U=h(""),K=h(""),H=h(""),Q=k((()=>K.value.match(/[^a-zA-Z\s]|\p{P}|\w+/g)));A((()=>{U.value=o.value.bot_name,H.value=o.value.welcome_message,K.value=o.value.prompt_setting}));const z=async e=>{try{const a=await l(await s.queryBotInfo({bot_id:e}));d(a[0])}catch(a){D.error(a.msg||"获取Bot信息失败")}},E=async()=>{try{await l(await s.updateBot({bot_id:o.value.bot_id,bot_name:U.value,prompt_setting:K.value,welcome_message:H.value,only_need_search_results:q.value.capabilities.onlySearch,networking:q.value.capabilities.networkSearch,api_base:q.value.apiBase,api_key:q.value.apiKey,api_context_length:q.value.apiContextLength,top_p:q.value.top_P,temperature:q.value.temperature,top_k:q.value.top_K,model:q.value.apiModelName,max_token:q.value.maxToken,hybrid_search:q.value.capabilities.mixedSearch,chunk_size:q.value.chunkSize,rerank:q.value.capabilities.rerank})),z(o.value.bot_id),D.success(L.saveSuccessful)}catch(e){D.error(e.msg||"保存失败，请重试")}},O=h(),V=async(e,a="应用成功")=>{const t=await O.value.onCheck();return!Object.hasOwn(t,"errorFields")&&(m(t),D.success(a),!0)};return a({handleOk:V}),(e,a)=>{const t=Z,c=W,d=R;return f(),b("div",ue,[w("div",de,[pe,y(t,{value:_(U),"onUpdate:value":a[0]||(a[0]=e=>C(U)?U.value=e:null),placeholder:_(L).inputBotName,"show-count":"",maxlength:25},null,8,["value","placeholder"])]),w("div",ve,S(_(L).roleSetting),1),y(c,{value:_(K),"onUpdate:value":a[1]||(a[1]=e=>C(K)?K.value=e:null),class:"role-setting-input","auto-size":{minRows:7,maxRows:7},rows:7},null,8,["value"]),w("div",{class:x(["role-setting-length",_(Q)&&_(Q).length>2e3?"over-length":""])},S(_(Q)?_(Q).length:0)+" / 2000 ",3),w("div",me,S(_(L).welcomeMessage),1),y(c,{value:_(H),"onUpdate:value":a[2]||(a[2]=e=>C(H)?H.value=e:null),class:"greeting-input","show-count":"",maxlength:100,placeholder:_(L).inputWelcomMsg,"auto-size":{minRows:6,maxRows:6},rows:6},null,8,["value","placeholder"]),w("div",ge,[I(S(_(L).associatedKb),1),he]),(f(!0),b(B,null,F(_(o).kb_ids,((e,a)=>(f(),b("div",{key:e,class:"knowedge-item knowledge-info"},[ke,w("div",Ae,S(_(o).kb_names[a]),1),w("img",{class:"remove-icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAQBSURBVFiF1Zk/aBtnFMB/73TWUJwUi0CoS4KHxEPw4n+0aQMpGWwPLaQYeywt0l0OFxwC7ZohawuhHoR9Z2jwaFEayFDbgyGQ4BaEp5DBWURCFZoauSTOoujuZdB3RpKNY8e25P4m6b67e7+7033fe0/C+yGO41wErgADItINdAInzPgroKiqa0AeWA6CYAXQfQfaz86u655V1QkR+Qb4aJ+xnqvqnIhkfd9/eqiCmUzmdCKRuKmqDtBmNj8BFkXkgao+LpfLz7q6ul4CFAqFk8lk8oyIXFDVS8AwcN4c90ZEgjAMb83Ozv5zYEHHcb4VkZ+AU0AFmAemfN//ay8XF+O67ifAJDAO2MC6qv4YBMGd9xIcGxtLplKp26o6YTYtqOr1IAjW9iPWiOM43SLyCzACICLZUql0I5fLlfcsODEx0V6pVH4DhoBN4Aff92cOItaI67rXgJ+BdmDJtu3RbDa7+U7BsbGxZEdHxz1gSFWLiURieHp6+tFhysV4ntcThuGiiHQCSxsbG1813kmr8aBUKnU7loui6PJRyQFMT08/iqLosqoWgSETu466O2heiF+BTcuyLh6lXC2e5/VEUbQCtKvqd7UvTiL+kMlkTluWdRf4AJicmZn5oxlyAPl8/kV/f38J+FJELvX29s6trq6+hppHnEgkblKdShYO+4XYCybmAnDKuLAlaFYIB6io6vVmy8WY2BVVdVzXPbslaOa6NmD+oPPcQTCx54G2eP61ADFrK8BUq+RqmAIwTiKO43wmIg+BJ77vd7fWrYrrumvAeVX93KKaMgEsttCpkdjligUMAIjIg9b51FPjMmCZZBNVfdxCpzpiFxHptqhmwpTL5WcttaqhxqXTxqTpcbK5G67r/g5cPWD8u77vf73bDl1dXS+LxSLAiW3JwnHDplrgfFgoFE4C/+2287uu/LAwJQPAKwsoAiSTyTPNCL4XalyKlikNEZELLXSqI3ZR1TWLat2Kqb6OBTUueQtYNl+GW+SzE7HLsgDiuu7fVAvxT/dbTh42pjz9E3ju+/7HFqCqOmfGJ1untsUkgHFSC6q1KfAGGHccp2UZjYk9TrX7kAWTsPq+/1REAsA2RXVLMLFtEQni/s3WShKG4S1gHRgxRXVTMTFHgHXjAtRUdaurq6/7+vr+FZGrwBeDg4P38vn8i2bIeZ7Xo6rzQFJVv5+dnX0Yj9WtxUEQ3DHPvj0Mw8V0On3uqOXS6fS5MAwXgXYRyTY2k7YlC6VS6QawJCKdlmXd9zyv56jkPM/rsSzrftz6MLHr2CaYy+XKtm2PxpJRFK0cxW/Sdd1rURStxHK2bY/u1OH6f7bfGk54PBuYtRzrFnAtx7aJvtNxzfob4i2ESvnrjyWOcQAAAABJRU5ErkJggg==",alt:"remove",onClick:a=>(async e=>{let a=o.value.kb_ids;a=a.filter((a=>a!=e));try{await l(await s.updateBot({bot_id:o.value.bot_id,kb_ids:a})),z(o.value.bot_id),n.value=n.value.map((a=>(a.kb_id===e&&(a.state=0===a.state?1:0),a))),D.success(L.removalSucessful)}catch(t){D.error(t.msg||"请求失败")}})(e)},null,8,fe)])))),128)),w("div",{class:"knowedge-item add-knowledge-content",onClick:a[3]||(a[3]=e=>_(r)(!0))},[be,I(" "+S(_(L).clickAssociatedKb),1)]),w("div",we,[y(d,{class:"save-btn",type:"primary",onClick:E},{default:T((()=>[I(S(_(L).save),1)])),_:1})]),w("div",ye,S(_(j).modelSettingTitle),1),y(u,{ref_key:"chatSettingFormRef",ref:O,"context-length":_(i).length},null,8,["context-length"]),w("div",_e,[y(d,{type:"primary",style:{width:"auto"},onClick:V},{default:T((()=>[I(S(_(j).confirmApplication),1)])),_:1})])])}}}),[["__scopeId","data-v-b73852ad"]]),Se=e=>(q("data-v-c8969e72"),e=e(),L(),e),xe={class:"bots-chat-container"},Ie={class:"my-page"},Be={class:"header"},Fe=Se((()=>w("img",{src:e,alt:"avatar"},null,-1))),Te={id:"chat",class:"chat"},De={class:"ai"},Re={class:"content"},qe=Se((()=>w("img",{class:"avatar",src:ae,alt:"头像"},null,-1))),Le=["innerHTML"],je={key:0,class:"user"},Ue=Se((()=>w("img",{class:"avatar",src:te,alt:"头像"},null,-1))),Ke={class:"question-text"},He={key:1,class:"ai"},Qe={class:"content"},ze=Se((()=>w("img",{class:"avatar",src:ae,alt:"头像"},null,-1))),Ee={key:1},Oe={key:0},Ve={key:1},Ye={class:"source-list"},Me={class:"control"},Xe={class:"tips"},Ze=["href"],We=["onClick"],Pe={class:"source-content"},Ge=["innerHTML"],Ne={class:"score"},Je={class:"tips"},$e={key:2,class:"feed-back"},ea=["onClick"],aa={class:"reload-text"},ta={class:"tools"},la={class:"stop-placeholder"},sa={class:"question-box"},oa={class:"question"},na={class:"send-plane"},ia={key:0,class:"mask"},ca=Se((()=>w("img",{src:oe,alt:"icon"},null,-1))),ra=j(m({__name:"Chat",props:{chatType:{type:String,default:"edit"},botInfo:{type:Object,default:()=>{}}},setup(e){const a=e,t=c().common,u=c().bots,m=new le((e=>{e&&(A.value[A.value.length-1].answer+=e||"")})),{QA_List:A}=g(v()),{chatSettingFormActive:q}=g(p()),{copy:L}=P(),{setChatSourceVisible:j,setSourceType:X,setSourceUrl:W,setTextContent:ae}=ne(),{language:te}=g(r()),oe=h(""),re=k((()=>{const e=q.value.context;if(0===e)return[];const a=A.value.filter((e=>"ai"===e.type));return(11===e?a:a.slice(-e)).map((e=>[e.question,e.answer]))})),ue=h(!1),de=h([]);let pe;const ve=h(null),me=h(null),ge=()=>{E((()=>{var e;null==(e=ve.value)||e.scrollIntoView(!1)}))},he=G(((e,a)=>{if(e.like=!e.like,e.unlike=!1,e.like){a.target.parentNode.style.animation="shake ease-in .5s";const e=setTimeout((()=>{clearTimeout(e),a.target.parentNode.style.animation=""}),600)}}),800),ke=e=>{A.value.push({answer:"",question:e,onlySearch:q.value.capabilities.onlySearch,type:"ai",copied:!1,like:!1,unlike:!1,source:[],picList:null,showTools:!1})},Ae=new i,fe=()=>{pe&&pe.abort(),m.done(),ue.value=!1,A.value[A.value.length-1].showTools=!0},be=async()=>{var e;if(!oe.value.trim().length)return;if(!oe.value.length)return void D.warn("正在聊天中...请等待结束");if(!(await pa()))return void D.error("模型设置错误，请先检查模型配置");const t=oe.value;oe.value="",(e=>{A.value.push({question:e,type:"user"}),ge()})(t),ue.value=!0,null==(e=ve.value)||e.scrollIntoView(!0),pe=new AbortController;se(n+"/local_doc_qa/local_doc_chat",{method:"POST",headers:{"Content-Type":"application/json",Accept:["text/event-stream","application/json"],"Transfer-Encoding":"chunked",Connection:"keep-alive"},openWhenHidden:!0,body:JSON.stringify({user_id:o,bot_id:a.botInfo.bot_id,history:re.value,question:t,streaming:!1===q.value.capabilities.onlySearch,networking:q.value.capabilities.networkSearch,product_source:"saas",rerank:q.value.capabilities.rerank,only_need_search_results:q.value.capabilities.onlySearch,hybrid_search:q.value.capabilities.mixedSearch,max_token:q.value.maxToken,api_base:q.value.apiBase,api_key:q.value.apiKey,model:q.value.apiModelName,api_context_length:q.value.apiContextLength,chunk_size:q.value.chunkSize,top_p:q.value.top_P,top_k:q.value.top_K,temperature:q.value.temperature}),signal:pe.signal,onopen(e){Ae.addChatSetting(q.value),e.ok&&"text/event-stream"===e.headers.get("content-type")?(ke(t),m.start()):"application/json"===e.headers.get("content-type")&&ke(t)},onmessage(e){var a;const t=JSON.parse(e.data);if(200==(null==t?void 0:t.code)&&(null==t?void 0:t.response)&&"success"===t.msg)m.add(null==t?void 0:t.response.replaceAll("\n","<br/>")),ge();else{delete t.time_record.time_usage.retriever_search_by_milvus,Ae.addTime(t.time_record.time_usage),Ae.addToken(t.time_record.token_usage),Ae.addDate(Date.now())}(null==(a=null==t?void 0:t.source_documents)?void 0:a.length)&&(A.value[A.value.length-1].source=null==t?void 0:t.source_documents)},onclose(e){m.done(),pe.abort(),ue.value=!1,A.value[A.value.length-1].showTools=!0,A.value.at(-1).itemInfo=Ae.getChatInfo(),E((()=>{ge()}))},onerror(e){throw m.done(),pe.abort(),ue.value=!1,A.value[A.value.length-1].showTools=!0,E((()=>{ge()})),e}})},{showModal:we}=g(N()),{clearQAList:ye}=v(),_e=h(!1),Ce=h(""),Se=h(""),ra=()=>{Se.value="download",we.value=!0,Ce.value=t.saveTip},ua=async()=>{if(_e.value=!0,"download"===Se.value)try{const e=document.getElementById("chat-ul"),a=(await $(e,{useCORS:!0})).toDataURL("image/png"),t=document.createElement("a");t.style.display="none",t.href=a,t.setAttribute("download","chat-shot.png"),void 0===t.download&&t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(a),D.success(u.downloadSuccessful),Promise.resolve()}catch(e){D.error(e.message||e.msg||"出错了")}else"delete"===Se.value&&ye();Se.value="",Ce.value="",_e.value=!1,we.value=!1},da=U("checkSettingOk"),pa=async()=>await da();let va=["pdf","docx","xlsx","txt","jpg","png","jpeg"];const ma=e=>{if(!e)return!1;const a=e.split(".");if(a.length){const e=a.pop();return!!va.includes(e)}return!1},ga=e=>{ma(e.file_name)&&async function(e){try{W(null);const a=await l(await s.getFile({file_id:e.file_id})),t=e.file_name.split(".").pop(),o=function(e){const a=va.indexOf(e);return ha[a]}(t);if(X(t),W(`data:${o};base64,${a.base64_content}`),"txt"===t){const e=atob(a.base64_content),t=decodeURIComponent(escape(e));ae(t),j(!0)}else j(!0)}catch(a){D.error(a.msg||"获取文件失败")}}(e)};let ha=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","image/jpeg","image/png","image/jpeg"];return ge(),(a,l)=>{const s=ce,o=R,n=Z;return f(),b(B,null,[w("div",xe,[w("div",Ie,[w("div",Be,[Fe,I(" "+S(e.botInfo.bot_name),1)]),w("div",Te,[w("ul",{id:"chat-ul",ref_key:"scrollDom",ref:ve},[w("div",De,[w("div",Re,[qe,w("p",{class:"question-text",innerHTML:e.botInfo.welcome_message},null,8,Le)])]),(f(!0),b(B,null,F(_(A),((e,a)=>{var l,o,n;return f(),b("li",{key:a},["user"===e.type?(f(),b("div",je,[Ue,w("p",Ke,S(e.question),1)])):(f(),b("div",He,[w("div",Qe,[ze,e.onlySearch?Q("",!0):(f(),b("p",{key:0,class:x(["question-text",[e.source.length||(null==(l=null==e?void 0:e.picList)?void 0:l.length)?"":"change-radius",e.showTools?"":"flashing"]])},[e.answer?(f(),O(ie,{key:0,content:e.answer},null,8,["content"])):(f(),b("span",Ee,S(e.answer),1)),Object.keys((null==(o=null==e?void 0:e.itemInfo)?void 0:o.tokenInfo)||{}).length?(f(),O(ee,{key:2,"chat-item-info":e.itemInfo},null,8,["chat-item-info"])):Q("",!0)],2))]),(null==(n=null==e?void 0:e.picList)?void 0:n.length)?(f(!0),b(B,{key:0},F(e.picList,((a,t)=>(f(),b("div",{key:a+t,class:x(["data-picList",e.source.length||t+1!==e.picList.length?"":"picList-radius"])},[y(s,{width:150,src:a,class:"responsive-image"},null,8,["src"])],2)))),128)):Q("",!0),e.source.length?(f(),b(B,{key:1},[w("div",{class:x(["source-total",_(de).includes(a)?"":"source-total-last"])},["zh"===_(te)?(f(),b("span",Oe,"找到了"+S(e.source.length)+"个信息来源：",1)):(f(),b("span",Ve,"Found "+S(e.source.length)+" source of information",1)),K(y(V,{name:"down",onClick:e=>(e=>{de.value.push(e)})(a)},null,8,["onClick"]),[[H,!_(de).includes(a)]]),K(y(V,{name:"up",onClick:e=>(e=>{de.value=de.value.filter((a=>a!==e))})(a)},null,8,["onClick"]),[[H,_(de).includes(a)]])],2),K(w("div",Ye,[(f(!0),b(B,null,F(e.source,((a,l)=>(f(),b("div",{key:l,class:"data-source"},[K(w("p",Me,[w("span",Xe,S(_(t).dataSource)+S(l+1)+":",1),a.file_id.startsWith("http")?(f(),b("a",{key:0,href:a.file_id,target:"_blank"},S(a.file_name),9,Ze)):(f(),b("span",{key:1,class:x(["file",ma(a.file_name)?"filename-active":""]),onClick:e=>ga(a)},S(a.file_name),11,We)),K(y(V,{name:"iconup",onClick:a=>((e,a)=>{e.source[a].showDetailDataSource=!1})(e,l)},null,8,["onClick"]),[[H,a.showDetailDataSource]]),K(y(V,{name:"icondown",onClick:a=>((e,a)=>{e.source[a].showDetailDataSource=!e.source[a].showDetailDataSource})(e,l)},null,8,["onClick"]),[[H,!a.showDetailDataSource]])],512),[[H,a.file_name]]),y(Y,{name:"sourceitem"},{default:T((()=>{var e;return[K(w("div",Pe,[w("p",{innerHTML:null==(e=a.content)?void 0:e.replaceAll("\n","<br/>")},null,8,Ge),w("p",Ne,[w("span",Je,S(_(t).correlation),1),I(S(a.score),1)])],512),[[H,a.showDetailDataSource]])]})),_:2},1024)])))),128))],512),[[H,_(de).includes(a)]])],64)):Q("",!0),e.showTools?(f(),b("div",$e,[w("div",{class:"reload-box",onClick:a=>(e=>{oe.value=e.question,be()})(e)},[y(V,{name:"reload"}),w("span",aa,S(_(t).regenerate),1)],8,ea),w("div",ta,[y(V,{style:M({color:e.copied?"#4D71FF":""}),name:"copy",onClick:a=>(e=>{L(e.answer).then((()=>{e.copied=!e.copied,D.success(t.copySuccess,1);const a=setTimeout((()=>{clearTimeout(a),e.copied=!e.copied}),1e3)})).catch((()=>{D.error(t.copyFailed,1)}))})(e)},null,8,["style","onClick"]),y(V,{style:M({color:e.like?"#4D71FF":""}),name:"like",onClick:a=>_(he)(e,a)},null,8,["style","onClick"]),y(V,{style:M({color:e.unlike?"#4D71FF":""}),name:"unlike",onClick:a=>(e=>{e.unlike=!e.unlike,e.like=!1})(e)},null,8,["style","onClick"])])])):Q("",!0)]))])})),128)),K(w("div",la,null,512),[[H,_(ue)]]),K(w("div",{ref_key:"stopBtn",ref:me,class:"stop-btn"},[y(o,{onClick:fe},{icon:T((()=>[y(V,{name:"stop",class:x(_(ue)?"loading":"")},null,8,["class"])])),default:T((()=>[I(" "+S(_(t).stop),1)])),_:1})],512),[[H,_(ue)]])],512)]),w("div",sa,[w("div",oa,["share"===e.chatType?(f(),b("span",{key:0,class:"download",onClick:ra},[y(V,{name:"chat-download"})])):Q("",!0),y(n,{value:_(oe),"onUpdate:value":l[0]||(l[0]=e=>C(oe)?oe.value=e:null),"max-length":"200",placeholder:_(t).problemPlaceholder,onKeyup:z(be,["enter"])},{suffix:T((()=>[w("div",na,[y(o,{type:"primary",disabled:_(ue),onClick:be},{default:T((()=>[y(V,{name:"sendplane"})])),_:1},8,["disabled"])])])),_:1},8,["value","placeholder"])])])]),e.botInfo.kb_ids&&e.botInfo.kb_ids.length?Q("",!0):(f(),b("div",ia,[ca,w("p",null,S(_(u).bindKbtoPreview),1)])),y(d,{ref:"chatSettingForDialogRef"},null,512)]),y(J,{content:_(Ce),"confirm-loading":_(_e),onOk:ua},null,8,["content","confirm-loading"])],64)}}}),[["__scopeId","data-v-c8969e72"]]),ua={class:"edit-detail"},da={class:"bots-chat-page"},pa=j(m({__name:"EditDetail",setup(e){const{curBot:a}=g(t()),l=h();return X("checkSettingOk",(()=>l.value.handleOk(null,"模型配置已自动保存"))),(e,t)=>(f(),b("div",ua,[y(Ce,{ref_key:"botDetailEditRef",ref:l},null,512),w("div",da,[y(ra,{"bot-info":_(a),"chat-type":"edit"},null,8,["bot-info"])])]))}}),[["__scopeId","data-v-3807c075"]]);export{pa as default};
